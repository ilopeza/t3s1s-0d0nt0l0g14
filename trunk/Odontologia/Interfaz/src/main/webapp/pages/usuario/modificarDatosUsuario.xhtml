<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../../templates/commonLayout.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="content">

        <h:form id="formModificarDatosUsuario">
            <h:outputLabel value="Modificar datos de usuario" style="padding: 400px; font-size: 20px; " />
            <p:panel id="pnlModificarDatosUsuario" header="Datos de usuario">
                <h:panelGrid id="gridModificarDatosUsuario" cellpadding="3" cellspacing="3" columns="2">

                    <p:column>
                        <h:outputLabel value="Nombre: "/>
                    </p:column>
                    <p:column>
                        <p:inputText id="txtModificarNombre" value="#{modificarDatosUsuarioBean.persona.nombre}" />
                    </p:column>

                    <p:column>
                        <h:outputLabel value="Apellido: "/>
                    </p:column>

                    <p:column>
                        <p:inputText id="txtModificarApellido" value="#{modificarDatosUsuarioBean.persona.apellido}"/>
                    </p:column>

                    <p:column>
                        <h:outputLabel value="E-mail: "/>
                    </p:column>

                    <p:column>
                        <p:inputText id="txtModificarEmail" value="#{modificarDatosUsuarioBean.persona.usuario.email}"/>
                    </p:column>

                    <p:column>
                        <h:outputLabel value="Fecha Nacimiento: "/>
                    </p:column>

                    <p:column>
                        <p:calendar id="txtModificarFechaNacimiento" value="#{modificarDatosUsuarioBean.persona.fechaNacimiento.time}"/>
                    </p:column>

                    <p:column>
                        <h:outputLabel value="Documento: "/>
                    </p:column>

                    <p:column>
                        <p:inputText id="txtModificarDocumento" disabled="true" value="#{modificarDatosUsuarioBean.persona.documento}"/>
                    </p:column>

                </h:panelGrid>            
            </p:panel>


            <p:panel id="pnlCambiarContraseña" header="Cambiar contraseña">

                <h:panelGrid columns="2" cellpadding="10">  
                    <h:outputLabel value="Contraseña actual: "/>

                    <p:password id="txtContraseñaActual" label="Contraseña actual" value="#{modificarDatosUsuarioBean.contraseñaActual}" required="false" 
                                />


                    <h:outputLabel for="pwd1" value="Nueva contraseña: "/>


                    <p:password id="pwd1" value="#{modificarDatosUsuarioBean.nuevaContraseña}" 
                                required="false" 
                                />

                    <h:outputLabel for="pwd2" value="Confirmar contraseña: "/>

                    <p:password id="pwd2" value="#{modificarDatosUsuarioBean.repetirContraseña}" required="false"/>

                </h:panelGrid> 

            </p:panel>
            <p:commandButton value="Guardar" id="btnAceptarModificacionDatosUsuario" 
                             action="#{modificarDatosUsuarioBean.guardarCambios()}" update=":msg"/>
            <p:commandButton value="Cancelar" id="btnCancelarModificacionDatosUsuario" action="#{modificarDatosUsuarioBean.volverAInicio()}"/>
        </h:form>   
        <p:confirmDialog message="¿Realmente quiere modificar sus datos?"
                         header="Modificar mis datos" severity="alert"
                         widgetVar="dlgConfirmar" appendToBody="true">
            <h:panelGrid id="pnlConfirmacionDatosUsuario" cellpadding="3" cellspacing="3" columns="2">
                <h:outputLabel value="Nombre: "/>
                <h:outputLabel value=":formModificarDatosUsuario:txtModificarNombre"/>             
                <h:outputLabel value="Apellido: "/>
                <h:outputLabel value="#{modificarDatosUsuarioBean.persona.apellido}"/>
                <h:outputLabel value="Correo electrónico: "/>
                <h:outputLabel value="#{modificarDatosUsuarioBean.persona.usuario.email}"/> 
                <h:outputLabel value="Fecha de nacimiento: "/>
                <h:outputLabel value="#{modificarDatosUsuarioBean.formatFecha(modificarDatosUsuarioBean.persona.fechaNacimiento)}"/> 
                <p:commandButton value="Sí" actionListener="#{modificarDatosUsuarioBean.guardarCambios()}"
                                 oncomplete="dlgConfirmar.hide();"/>

                <p:commandButton value="No" onclick="dlgConfirmar.hide();" type="button" />
            </h:panelGrid>
        </p:confirmDialog>

        <p:dialog id="messages" widgetVar="dlgConfirmarModificacionUsuario" modal="true" closable="true" appendToBody="true"
                  header="Confirmar modificacion de usuario">
            <h:form>

                <h:panelGrid id="pnlConfirmacionDatosUsuario" cellpadding="3" cellspacing="3" columns="2">
                    <h:outputLabel value="Nombre: "/>
                    <h:outputLabel value="#{modificarDatosUsuarioBean.persona.nombre}"/>             
                    <h:outputLabel value="Apellido: "/>
                    <h:outputLabel value="#{modificarDatosUsuarioBean.persona.apellido}"/>
                    <h:outputLabel value="Correo electrónico: "/>
                    <h:outputLabel value="#{modificarDatosUsuarioBean.persona.usuario.email}"/> 
                    <h:outputLabel value="Fecha de nacimiento: "/>
                    <h:outputLabel value="#{modificarDatosUsuarioBean.formatFecha(modificarDatosUsuarioBean.persona.fechaNacimiento)}"/> 


                </h:panelGrid>

                <p:commandButton value="Aceptar" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
                                 actionListener="#{modificarDatosUsuarioBean.guardarCambios()}"
                                 oncomplete="dlgConfirmarModificacionUsuario.hide()"/>  
                <p:commandButton value="Cancelar" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"
                                 onclick="dlgConfirmarModificacionUsuario.hide();"/>
            </h:form>
        </p:dialog>
    </ui:define>

</ui:composition>
