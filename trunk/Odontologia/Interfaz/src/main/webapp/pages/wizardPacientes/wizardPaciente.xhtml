<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../../templates/commonLayout.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:define name="content">
        <h:outputLabel value="#{msg.lblRegistrarPaciente}" style="padding: 400px; font-size: 20px; font: " />
        <h:form id="consultarPacienteForm">
            <p:panel id="pnlConsultarPaciente" header="#{msg.lblConsultarPaciente}" >

                <h:outputLabel value="#{msg.lblBuscarPorNumApeNom}: "/>
                <p:inputText id="txtDocumentoBusqueda" value="#{pacienteWizardBean.numDocumentoBusqueda}"/>

                <h:outputLabel value="Nombre o apellido: "/>
                <p:inputText id="txtNombreBusqueda" value="#{pacienteWizardBean.nombreApellidoBusqueda}"/>

                <p:commandButton value="#{msg.btnBuscar}" id="btnBuscar"
                                 process="@form"
                                 oncomplete="dlgPacientesEncontrados.show()"
                                 update=":secondaryForm:tablaPacientesEncontrados, :msg" 
                                 actionListener="#{pacienteWizardBean.buscarPacientes()}" 
                                 icon="ui-icon-search"/>

                <p:commandButton value="#{msg.btnModificar}" id="btnModificar"
                                 actionListener="#{pacienteWizardBean.habilitar}"
                                 disabled="#{!pacienteWizardBean.estaDeshabilitado}"
                                 update="pnlConsultarPaciente, 
                                 :formWizard"
                                 icon="ui-icon-pencil"/>

                <p:commandButton value="#{msg.btnVerHistoriaClinica}" id="btnVerHC"
                                 action="#{pacienteWizardBean.cargarPaciente()}"
                                 disabled="#{!pacienteWizardBean.estaDeshabilitado}">
                </p:commandButton>
            </p:panel>
        </h:form>
        <p:panel id="pnlTabsPaciente" header="#{msg.lblDatosPaciente}">
            <h:form id="formWizard">
                <p:wizard id="wizardPaciente">
                    <p:tab title="#{msg.lblDatosPersonales}" id="tabDatosPersonales">
                        <ui:include src="./tabsWizardPaciente/tabDatosPersonales.xhtml"/>
                    </p:tab>
                    <!--p:tab title="Datos de la consulta" id="tabDatosConsulta">
                        <ui:include src="./tabsWizardPaciente/tabDatosConsulta.xhtml"/>
                    </p:tab-->
                    <p:tab title="#{msg.lblDiagnosticos}" id="tabDatosDiagnostico">
                        <ui:include src="./tabsWizardPaciente/tabDiagnostico.xhtml"/>
                    </p:tab>
                </p:wizard>
                <!--p:confirmDialog message="¿Realmente quiere cancelar el diagnóstico?"
                                 header="Cancelar diagnóstico" severity="alert"
                                 widgetVar="dlgCancelar" appendToBody="true">
                    <p:commandButton value="Sí" action="{pacienteWizardBean.cancelarDiagnostico()}"
                                     oncomplete="dlgCancelar.hide();"
                                     update="tblVerDiagnosticosCargados"
                                     process="tblVerDiagnosticosCargados"/>
                    <p:commandButton value="No" onclick="dlgCancelar.hide();" type="button" />
                </p:confirmDialog-->
            </h:form>
        </p:panel>

        <p:dialog header="#{msg.lblConsultarPaciente}" widgetVar="dlgPacientesEncontrados" resizable="false" appendToBody="true" modal="true" >
            <h:form id="secondaryForm">
                <p:dataTable id="tablaPacientesEncontrados" 
                             var="paciente" value="#{pacienteWizardBean.pacientesEncontrados}"
                             selectionMode="single"
                             selection="#{pacienteWizardBean.selectedPaciente}"
                             rowKey="#{paciente.id}"
                             paginator="true" 
                             rows="10"                             
                             rowsPerPageTemplate="5,10,15"
                             paginatorAlwaysVisible="false"
                             emptyMessage="#{msg.msgPacientes}">

                    <f:facet name="header" >  
                        <p:outputPanel>  
                            <h:outputText value="#{msg.lblPacientesEncontrados}" />                  
                        </p:outputPanel>  
                    </f:facet>                                   

                    <p:column headerText="#{msg.lblNumDoc}">  
                        <h:outputText value="#{paciente.documento}" />  
                    </p:column>

                    <p:column headerText="#{msg.lblApeNom}">  
                        <h:outputText value="#{paciente}" />  
                    </p:column>

                    <p:column headerText="#{msg.lblDomicilio}">  
                        <h:outputText value="#{paciente.domicilio}" />  
                    </p:column>

                </p:dataTable>
                <br/>
                <p:commandButton value="#{msg.btnSeleccionar}" id="btnAceptar" 
                                 oncomplete="dlgPacientesEncontrados.hide()"
                                 actionListener="#{pacienteWizardBean.mostrarPacienteSeleccionado()}"
                                 update=":formWizard:wizardPaciente,
                                 :consultarPacienteForm:pnlConsultarPaciente"
                                 icon="ui-icon-pin-w"
                                 />
            </h:form>
        </p:dialog>  

        <p:confirmDialog message="#{msg.msgBajaDiag}"
                         header="#{msg.lblDarBajaDiag}" severity="alert"
                         widgetVar="dlgBajaDeDianostico" appendToBody="true">
            <p:commandButton value="#{msg.btnConfirmar}" actionListener="#{pacienteWizardBean.cancelarDiagnosticoEnMemoria()}"
                             oncomplete="dlgBajaDeDianostico.hide();"
                             update=":formWizard:tblResultadoDiagnosticos"
                             icon="ui-icon-circle-check"/>
            <p:commandButton value="#{msg.btnCancelar}" onclick="dlgBajaDeDianostico.hide();" type="button" 
                             icon="ui-icon-cancel"/>
        </p:confirmDialog>

        <p:confirmDialog message="¿Desea eliminar o modificar el diagnóstico seleccionado?"
                         header="#{msg.lblModifDiag}" severity="alert"
                         widgetVar="dlgModificarDiagnostico" id="dlgModificar" appendToBody="true">
            <p:commandButton value="#{msg.btnConfirmar}" actionListener="#{pacienteWizardBean.seleccionarModificarDiagnostico()}"
                             oncomplete="dlgModificarDiagnostico.hide();"
                             update=":formWizard:pnlNuevoDiagnostico"
                             icon="ui-icon-pencil"/>
            <p:commandButton value="Eliminar" actionListener="#{pacienteWizardBean.eliminarDiagnosticoEnMemoria()}"
                             oncomplete="dlgModificarDiagnostico.hide();" 
                             update=":formWizard:pnlDiagnosticosCargados"
                             icon="ui-icon-closethick"/>
            <p:commandButton value="#{msg.btnCancelar}" onclick="dlgModificarDiagnostico.hide();" type="button" icon="ui-icon-arrowreturnthick-1-w" />
        </p:confirmDialog>

    </ui:define>
</ui:composition>


