<ui:composition xmlns:h="http://java.sun.com/jsf/html"
                template="./../../templates/commonLayout.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns="http://www.w3.org/1999/xhtml">

    <ui:define name="content">
        <h:outputLabel value="CONSULTAR ASIGNACIONES DE PACIENTES CONFIRMADAS" style="padding: 400px; font-size: 20px; font: " />
 
        <h:form id="consultarAsignacionesConfirmadasForm">
            <p:panel id="pnlConsultarAsignacionesConfirmadas" header="Parámetros de búsqueda">
                <h:panelGrid id="paramentros" columns="4" cellpadding="3" cellspacing="3">                 
  
                    <p:outputLabel value="Materia "/>
                    <p:selectOneMenu id="selecciontMateriaBusqueda" value="#{consultarAsignacionesConfirmadasBean.materiaFiltro}" converter="materiaConverter">
                        <f:selectItem itemLabel="Seleccione una Materia"/>
                        <f:selectItems value="#{consultarAsignacionesConfirmadasBean.materias}"/>
                        <f:ajax event="change"  render="seleccionCatedraBusqueda seleccionTrabajoPracticoBusqueda" execute="selecciontMateriaBusqueda"
                                listener="#{consultarAsignacionesConfirmadasBean.filtrarCombosPorMateria()}"/>
                    </p:selectOneMenu>     
                    
                    <p:outputLabel value="Trabajo práctico"/>
                    <p:selectOneMenu id="seleccionTrabajoPracticoBusqueda" value="#{consultarAsignacionesConfirmadasBean.trabajoPracticoFiltro}"
                                     converter="trabajoPracticoConverter">
                        <f:selectItem itemLabel="Seleccione un trabajo práctico"/>
                        <f:selectItems value="#{consultarAsignacionesConfirmadasBean.trabajosPracticos}"/>
                    </p:selectOneMenu>
                    
                     <p:outputLabel value="Cátedra de Atención " />
                    <p:selectOneMenu id="seleccionCatedraBusqueda" value="#{consultarAsignacionesConfirmadasBean.catedraFiltro}" converter="catedraConverter">
                        <f:selectItem itemLabel="Seleccione una Cátedra"/>
                        <f:selectItems value="#{consultarAsignacionesConfirmadasBean.catedras}"/>
                    </p:selectOneMenu>                    
                     <span></span> 
                      <h:outputLabel value=""/>
                     <h:outputLabel value="Fecha de Atención Desde:"/>
                     <p:calendar id="calDesde" value="#{consultarAsignacionesConfirmadasBean.fechaDesdeFiltro}" navigator="true"  yearRange="c-100:c"/>
                     
                     <h:outputLabel value="Fecha de Atención Hasta:"/>
                     <p:calendar id="calHasta" value="#{consultarAsignacionesConfirmadasBean.fechaHastaFiltro}" navigator="true"  yearRange="c-100:c"/>
                    
                     <h:outputText value="Asignaciones Autorizadas " />  
                     <p:selectBooleanCheckbox id="autorizada" value="#{consultarAsignacionesConfirmadasBean.estaAutorizada}" />
                     <f:ajax event="click" execute="autorizada" listener="#{consultarAsignacionesConfirmadasBean.habilitarAutorizar()}"/>
                </h:panelGrid>
                <br/>

                <p:commandButton  id="btnBuscarAsignacionesConfirmadas" value="Buscar Asignaciones Confirmadas" 
                                  actionListener="#{consultarAsignacionesConfirmadasBean.buscarAsignacionesConfirmadas()}" 
                                  process="@form"
                                  update="tblResultadosAsignacionesConfirmadas, :msg">
                </p:commandButton>
            </p:panel>
            <br/>
            <br/>
            <p:panel  id="pnlResultadosConsultarAsignacionesConfirmadas" header="Resultados de Búsqueda">
                <p:dataTable id="tblResultadosAsignacionesConfirmadas" var="asignaciones" value="#{consultarAsignacionesConfirmadasBean.asignacionesConfirmadas}"  paginator="true" rows="10"
                             emptyMessage="No se registran asignaciones confirmadas para los parámetros ingresados" selection="#{consultarAsignacionesConfirmadasBean.selectedAsignacionesAutorizadas}" 
                             rowKey="#{asignaciones.id}">  

                    <f:facet name="header">
                        <p:outputPanel>
                            <h:outputText value="Resultado de la Busqueda" />
                        </p:outputPanel>
                    </f:facet>
                    
                    <p:column selectionMode="multiple"/>
                    <p:column>  
                        <f:facet name="header">  
                            <h:outputText value="Paciente" />  
                        </f:facet>  
                        <h:outputText value="#{asignaciones.paciente}" />  
                    </p:column>  

                    <p:column>  
                        <f:facet name="header">  
                            <h:outputText value="Alumno" />  
                        </f:facet>  
                        <h:outputText value="#{asignaciones.alumno}" />  
                    </p:column>  


                    <p:column>  
                        <f:facet name="header">  
                            <h:outputText value="Fecha de Atención" />  
                        </f:facet>  
                        <h:outputText value="#{asignaciones.fecha}"/>
                    </p:column>
                    
                    <p:column>  
                        <f:facet name="header">  
                            <h:outputText value="Diagnóstico" />  
                        </f:facet>  
                        <h:outputText value="#{asignaciones.descripcionDiagnostico}"/>
                    </p:column>
                    
                    <p:column>  
                        <f:facet name="header">  
                            <h:outputText value="Materia" />  
                        </f:facet>  
                        <h:outputText value="#{asignaciones.materia}"/>
                    </p:column>
                    
                    <p:column>  
                        <f:facet name="header">  
                            <h:outputText value="Cátedra de Atención" />  
                        </f:facet>  
                        <h:outputText value="#{asignaciones.catedra}"/>
                    </p:column>
                    
                    <p:column>  
                        <f:facet name="header">  
                            <h:outputText value="Trabajo Práctico" />  
                        </f:facet>  
                        <h:outputText value="#{asignaciones.trabajoPractico}"/>
                    </p:column>
                    
                    <f:facet name="footer">  
                        <p:commandButton id="autorizarAsignaciones" value="Autorizar" action="#{consultarAsignacionesConfirmadasBean.autorizarAsignaciones()}" update="tblResultadosAsignacionesConfirmadas" disabled="#{consultarAsignacionesConfirmadasBean.habilitarBotonAutorizar}"/>  
                </f:facet> 

                </p:dataTable>
            </p:panel>
            <br/>
            <br/>
            <p:panel id="pnlExportarAsignacionesConfirmadas" header="Exportar Datos">
                <h:commandLink>  
                    <p:graphicImage library="images" name ="Excel.png" />  
                    <p:dataExporter type="xls" target="tblResultadosAsignacionesConfirmadas" fileName="Busqueda Paciente Confirmados"/>  
                </h:commandLink>
                <h:commandLink>
                    <p:graphicImage library="images" name ="pdf.png" />  
                    <p:dataExporter type="pdf" target="tblResultadosAsignacionesConfirmadas" fileName="Busqueda Paciente Confirmados"/>  
                </h:commandLink> 
            </p:panel>
        </h:form>

    </ui:define>
</ui:composition>


