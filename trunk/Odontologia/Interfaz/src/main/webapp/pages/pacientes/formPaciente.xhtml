<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../../templates/commonLayout.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:define name="content">
        <h:outputLabel value="REGISTRO DE PACIENTE" style="padding: 400px; font-size: 20px; font: " />
        <h:form id="consultarPacienteForm">
            <p:panel id="pnlConsultarPaciente" header="CONSULTAR PACIENTE" >

                <h:outputLabel value="Número de documento: "/>
                <p:inputText id="txtDocumentoBusqueda" value="#{formPacienteBean.nroDocumentoFiltro}"/>

                <h:outputLabel value="Nombre o apellido: "/>
                <p:inputText id="txtNombreBusqueda" value="#{formPacienteBean.nombreFiltro}"/>

                <p:commandButton value="Buscar" id="btnBuscar"
                                 process="txtNombreBusqueda, txtDocumentoBusqueda"
                                 oncomplete="dlgPacientesEncontrados.show()"
                                 update=":secondaryForm:tablaPacientesEncontrados" 
                                 actionListener="#{formPacienteBean.buscarPacientes()}" 
                                 icon="ui-icon-search"/>

                <p:commandButton value="Modificar" id="btnModificar"
                                 actionListener="#{formPacienteBean.habilitar}"
                                 disabled="#{!formPacienteBean.estaDeshabilitado}"
                                 update="pnlConsultarPaciente, 
                                 :tabsPaciente"/>

            </p:panel>
        </h:form>
        <p:panel id="pnlTabsPaciente" header="DATOS PACIENTE">
            <p:tabView id="tabsPaciente">
                <p:tab title="Datos personales" id="tabDatosPersonales">
                    <h:form id="datosPersonalesForm">
                        <ui:include src="./tabsFormPaciente/tabDatosPersonales.xhtml"/>
                    </h:form>
                </p:tab>
                <p:tab title="Datos de la consulta" id="tabDatosConsulta">
                    <h:form id="datosConsultaForm">
                        <ui:include src="./tabsFormPaciente/tabDatosConsulta.xhtml"/>
                    </h:form>
                </p:tab>
                <p:tab title="Diagnóstico" id="tabDiagnostico">
                    <h:form id="diagnosticoForm">
                        <!--ui:include src="./tabsFormPaciente/tabDiagnostico.xhtml"/-->
                    </h:form>

                </p:tab>
            </p:tabView>
        </p:panel>

        <p:dialog header="Busqueda Pacientes" widgetVar="dlgPacientesEncontrados" resizable="false" appendToBody="true" modal="true" >
            <h:form id="secondaryForm">
                <p:dataTable id="tablaPacientesEncontrados" 
                             var="paciente" value="#{formPacienteBean.pacientes}"
                             selectionMode="single"
                             selection="#{formPacienteBean.pacienteSeleccionado}"
                             rowKey="#{paciente.id}"
                             paginator="true"
                             paginatorAlwaysVisible="false"
                             rows="10">

                    <f:facet name="header" >  
                        <p:outputPanel>  
                            <h:outputText value="Busqueda de Pacientes Odontológicos" />                  
                        </p:outputPanel>  
                    </f:facet>                                   

                    <p:column headerText="Documento">  
                        <h:outputText value="#{paciente.documento}" />  
                    </p:column>

                    <p:column headerText="Apellido y Nombre">  
                        <h:outputText value="#{paciente}" />  
                    </p:column>

                    <p:column headerText="Domicilio">  
                        <h:outputText value="#{paciente.domicilio}" />  
                    </p:column>

                </p:dataTable>
                <br/>
                <p:commandButton value="Seleccionar" id="btnAceptar" 
                                 oncomplete="dlgPacientesEncontrados.hide()"
                                 actionListener="#{formPacienteBean.seleccionarPaciente}"
                                 update=":tabsPaciente,
                                 :consultarPacienteForm:pnlConsultarPaciente" />
            </h:form>
        </p:dialog>            
    </ui:define>
</ui:composition>


